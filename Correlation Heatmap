import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

excel_file = pd.ExcelFile('/mnt/20250309.xlsx')

df = excel_file.parse('Sheet1')

col_name_mapping = {
    '事故发生时段-标号': 'Accident Time Period',
    '路段信息-标号': 'Road Section Information',
    '天气-标号': 'Weather',
    '道路的线形-标号': 'Road Alignment',
    '最高允许车速(km/h)': 'Maximum Permitted Speed (km/h)',
    '路面材料-标号': 'Pavement Material',
    '道路表面污染-标号': 'Road Surface Contamination',
    '路表潮湿度-标号': 'Road Surface Moisture',
    '路面状况-标号': 'Pavement Condition',
    '驾龄': 'Driving Experience',
    '行人运动状态标号': 'Pedestrian Movement State',
    '车龄': 'Vehicle Age',
    '年龄d': 'Driver Age',
    '司机性别-标号': 'Driver Gender',
    '年龄p': 'Pedestrian Age',
    '行人性别-标号': 'Pedestrian Gender',
    '是否超速-标号': 'Speeding',
    '行人受伤情况': 'Pedestrian Injury Condition'
}

df = df.rename(columns=col_name_mapping)

plt.rcParams['figure.dpi'] = 300

plt.rcParams['font.sans-serif'] = ['WenQuanYi Zen Hei']
plt.rcParams['axes.unicode_minus'] = False

plt.figure(figsize=(18, 8))

correlation_matrix = df.corr()

ax = sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')

plt.xticks(rotation=15, ha='right')

plt.title('Correlation Heatmap')

plt.show()
